---
title: "Using AGROMET API to get weather data"
author: "Loïc Davadan"
date: 2018-05-30
output: html_document
---



<p>An API (Application Programming Interface) allows connections to be established between several software programs to exchange data. It needs the authentification of the user with a API key or token. Storing the API key in a script enables to call it in other commands to modify the files of the API. This token will not be available for other users, avoiding in that way an abusive use of this key by others.</p>
<div id="storage-of-the-api-key" class="section level1">
<h1>Storage of the API key</h1>
<div id="creation-of-the-user-on-the-api" class="section level2">
<h2>Creation of the user on the API</h2>
<p>Create a new user on the API will request different informations as the name and the password. Then, the API will generate a token for every user.</p>
</div>
<div id="storage-of-the-token-in-a-environment-variable" class="section level2">
<h2>Storage of the token in a environment variable</h2>
<p>Create a text file named “.Renviron” in your Home folder. This file is a R config file.</p>
<p>Copy this key in a new variable : <code>AGROMET_TOKEN = your_token</code></p>
</div>
</div>
<div id="get-data-from-the-agromet-api" class="section level1">
<h1>Get data from the AGROMET API</h1>
<p>Store in a variable <code>records.df</code> the result of the fonction <code>get_from_agromet_API.fun(user_token.chr, table_name.chr, sensors.chr=NULL, stations_ids.chr, dfrom.chr, dto.chr)</code> where :</p>
<ul>
<li><code>user_token.chr</code></li>
</ul>
<p>Character vector containing your own token.</p>
<ul>
<li><code>table_name.chr</code></li>
</ul>
<p>Character vector containing the name of the table you want to query.</p>
<p>Available table names are : <code>station</code>, <code>cleandata</code>, <code>cleandatafio</code>, <code>rawdata</code>, <code>rawdatafio</code>, <code>get_daily</code>, <code>get_tmy</code>.</p>
<ul>
<li><code>sensors.chr</code></li>
</ul>
<p>Character vector containing the name of the sensors you want to query.</p>
<p>Available sensor names are : <code>tsa</code>, <code>hra</code>, <code>plu</code>, <code>ens</code>, <code>vvt</code>, <code>sunset</code>, <code>sunrise</code>. (You can use <code>all</code> to get them all).</p>
<ul>
<li><code>stations_ids.chr</code></li>
</ul>
<p>Character vector containing the ids of the stations you want to query. (You can Use <code>all</code> to get them all).<br />
* <code>dfrom.chr</code></p>
<p>Character vector specifying the date from which you want data.</p>
<p>Formatted <code>yyyy-mm-dd</code> excepted for <code>get_tmy</code> where you must provide <code>mm-dd</code></p>
<ul>
<li><code>dto.chr</code></li>
</ul>
<p>Character vector specifying the date to which you want data.</p>
<p>Formatted <code>yyyy-mm-dd</code> excepted for <code>get_tmy</code> where you must provide <code>mm-dd</code></p>
<p>You will obtain raw data that you cannot use. You need to transform them to have them in a table. To do this, we will use the fonction <code>prepare_agromet_API_data.fun(records.df)</code> in which we will call our precedent variable. Then, your results will appear in a table.</p>
</div>
